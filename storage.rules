rules_version = '2';

// Firebase Storage Security Rules
service firebase.storage {
  match /b/{bucket}/o {
    // Rules for bucket files: buckets/{bucketId}/files/{fileName}
    match /buckets/{bucketId}/files/{fileName} {
      // Allow authenticated users to read/write/delete their own bucket files
      allow read, write, delete: if request.auth != null;
      
      // Allow unauthenticated users (PIN users) to read and upload files to any bucket
      // PIN users can upload but cannot delete existing files
      allow read, write: if request.auth == null;
    }
  }
}